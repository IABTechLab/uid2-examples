<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>UID2 Prebid.js Client-Server Integration Example</title>
    <link rel="stylesheet" type="text/css" href="./app.css" />
    <script async src="./prebid.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      console.log('Initializing example.');

      function updateGuiElements() {
        console.log('Updating displayed values.');
        // TODO: Update with actual UID2 token status
        $('#targeted_advertising_ready').text('no');
        $('#advertising_token').text('');
        $('#login_form').show();
        $('#clear_storage_form').hide();
      }

      async function handleLogin() {
        const email = $('#email').val();
        console.log('Login clicked with email:', email);
        // TODO: Call server endpoint to generate token
        updateGuiElements();
      }

      function handleClearStorage() {
        console.log('Clearing storage.');
        // TODO: Clear UID2 token
        location.reload();
      }

      function onDocumentReady() {
        console.log('Setting up interface handlers.');
        $('#login').click(handleLogin);
        $('#clear_storage').click(handleClearStorage);
        
        updateGuiElements();
      }

      $(document).ready(onDocumentReady);
    </script>
  </head>
  <body>
    <h1>UID2 Prebid.js Client-Server Integration Example</h1>
    <p class="intro">
      This example demonstrates how a content publisher can integrate with UID2 and Prebid.js using the <a href="https://unifiedid.com/docs/guides/integration-prebid-client-server">UID2 Client-Server Integration Guide for Prebid.js</a>, where tokens are generated on the server and passed to Prebid.js on the client side.
      <strong>Note:</strong> This is a <em>test-only</em> integration environmentâ€”not for production use.
      It does not perform real user authentication or generate production-level tokens.
      Do not use real user data on this page.
    </p>
    <table id="uid2_state">
      <tr>
        <td class="label">Ready for Targeted Advertising:</td>
        <td class="value"><pre id="targeted_advertising_ready"></pre></td>
      </tr>
      <tr>
        <td class="label">UID2 Advertising Token:</td>
        <td class="value"><pre id="advertising_token"></pre></td>
      </tr>
    </table>
    <div id="test-div">
    </div>
    <div id="login_form" style="display: none" class="form">
      <div class="email_prompt">
        <input
          type="text"
          id="email"
          name="email"
          placeholder="Enter an email address"
          style="border-style: none"
        />
      </div>
      <div><button type="button" class="button" id="login">Generate UID2</button></div>
    </div>
    <div id="clear_storage_form" style="display: none" class="form">
      <form>
        <button type="button" class="button" id="clear_storage">Clear UID2</button>
      </form>
    </div>
  </body>
</html>

