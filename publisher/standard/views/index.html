<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>UID2 Publisher Standard Integration Example</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/app.css" />
    <link rel="shortcut icon" href="/images/favicon.png" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="<%- uid2BaseUrl %>/static/js/uid2-sdk-1.0.0.js"></script>
    <script>
      $(document).ready(() => {
        let callbackCounter = 0;

        function updateGuiElements(state) {
          $("#advertising_token").html(__uid2.getAdvertisingToken());
          $("#login_required").html(__uid2.isLoginRequired() ? "yes" : "no");
          $("#update_counter").html(callbackCounter);
          $("#identity_state").html(JSON.stringify(state, null, 2));

          if (__uid2.isLoginRequired()) {
            $("#login_form").show();
            $("#logout_form").hide();
          } else {
            $("#login_form").hide();
            $("#logout_form").show();
          }
        }

        function onUid2IdentityUpdated(state) {
          ++callbackCounter;
          updateGuiElements(state);
        }

        updateGuiElements(undefined);

        __uid2.init({
          callback: onUid2IdentityUpdated,
          baseUrl: "<%- uid2BaseUrl %>"
        });
      });
    </script>
  </head>
  <body>
    <h1>UID2 Publisher Standard Integration Example</h1>
    <table id="uid2_state">
      <tr><td class="label">UID2 Advertising Token:</td><td class="value"><pre id="advertising_token"></pre></td></tr>
      <tr><td class="label">Is UID2 login required?</td><td class="value"><pre id="login_required"></pre></td></tr>
      <tr><td class="label">UID2 Identity Updated Counter:</td><td class="value"><pre id="update_counter"></pre></td></tr>
      <tr><td class="label">UID2 Identity State:</td><td class="value"><pre id="identity_state"></pre></td></tr>
    </table>
    <div id="login_form" style="display:none" class="form"><form action="/login" method="POST">
      <div class="email_prompt"><input type="text" id="email" name="email" placeholder="Enter an email address" style="border-style: none;"></div>
      <div><input type="submit" value="Login" class="button"></div>
    </form></div>
    <div id="logout_form" style="display:none" class="form"><form action="/logout" method="POST">
      <input type="submit" value="Logout" class="button">
    </form></div>
  </body>
</html>
